import pandas as pd
from models import *

# Ler a planilha do Excel
excel_file = 'c:\\Users\\jaderson.moreira\\Desktop\\carga.xlsx'
df = pd.read_excel(excel_file)

# Iterar sobre as linhas da planilha e atualizar os documentos no MongoDB
for index, row in df.iterrows():
    cod_registro = row['cod_registro']
    nr_solicitacao = row['nr_solicitacao']
    oc = row['oc']
    NF = row['NF']
    vlr_oc = row['vlr_oc']

    # Atualizar o documento no MongoDB com base no cod_registro
    col_solicitacao.update_one(
        {'cod_registro': cod_registro},
        {'$set': {'nr_solicitacao': int(nr_solicitacao), 'oc': int(oc), 'NF': int(NF), 'vlr_oc': float(vlr_oc)}}
    )

# Fechar a conex√£o com o MongoDB
client.close()
